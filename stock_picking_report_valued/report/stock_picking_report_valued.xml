<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template id="valued_report_picking" inherit_id="stock.report_delivery_document" >
        <xpath expr="//div[hasclass('page')]" position="before">
            <t t-set="is_outgoing" t-value="o.picking_type_code == 'outgoing'"/>
        </xpath>
        <xpath expr="//table[@name='stock_move_line_table']/thead/tr" position="inside">
            <t t-if="o.valued and o.sale_id and o.move_line_ids and is_outgoing">
                <th class="text-end">
                    <strong>Unit Price</strong>
                </th>
                <th class="text-end" groups="product.group_discount_per_so_line">
                    <strong>Discount</strong>
                </th>
                <th class="text-end">
                    <strong>Taxes</strong>
                </th>
                <th class="text-end">
                    <strong>Subtotal</strong>
                </th>
            </t>
        </xpath>
        <xpath expr="///table[@name='stock_move_line_table']" position="after">
            <t t-if="o.valued and o.sale_id and o.move_line_ids and is_outgoing">
                <table class="table table-sm mt32">
                    <thead>
                        <tr>
                            <th class="text-end">
                                <strong>Untaxed Amount</strong>
                            </th>
                            <th class="text-end">
                                <strong>Taxes</strong>
                            </th>
                            <th class="text-end">
                                <strong>Total</strong>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="text-end">
                                <span t-field="o.amount_untaxed"/>
                            </td>
                            <td class="text-end">
                                <span t-field="o.amount_tax"/>
                            </td>
                            <td class="text-end">
                                <span t-field="o.amount_total"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </t>
        </xpath>
    </template>

    <template id="valued_report_picking_has_serial_move_line" inherit_id="stock.stock_report_delivery_has_serial_move_line">
        <xpath expr="." position="inside">
            <t t-if="o.state=='done' and o.valued and o.sale_id and o.move_line_ids and is_outgoing">
                <td class="text-end">
                    <span t-field="move_line.sale_price_unit"/>
                </td>
                <td class="text-end" groups="product.group_discount_per_so_line">
                    <span t-field="move_line.sale_discount"/>
                </td>
                <td class="text-end">
                    <span
                            t-field="move_line.sale_tax_description"
                    />
                </td>
                <td class="text-end">
                    <span
                            t-field="move_line.sale_price_subtotal"
                    />
                </td>
            </t>
        </xpath>
    </template>

    <template id="stock_report_delivery_aggregated_move_lines" inherit_id="stock.stock_report_delivery_aggregated_move_lines">
        <xpath expr="//tr" position="inside">
            <t t-if="o.state=='done' and o.valued and o.sale_id and o.move_line_ids and is_outgoing">
                <td class="text-center" name="move_line_aggregated_Unit_Price">
                    <t t-if="aggregated_lines[line]['sale_price_unit']">
                        <span t-esc="aggregated_lines[line]['sale_price_unit']"
                              t-options="{'widget': 'float', 'precision': aggregated_lines[line]['currency'].decimal_places}"
                        />
                    </t>
                </td>
                <td class="text-center" name="move_line_aggregated_sale_discount">
                        <span t-esc="aggregated_lines[line]['sale_discount']"
                              t-options="{'widget': 'float', 'precision': aggregated_lines[line]['currency'].decimal_places}"
                        />
                </td>
                <td class="text-center" name="move_line_aggregated_sale_tax_description">
                    <t t-if="aggregated_lines[line]['sale_tax_description']">
                        <span t-esc="aggregated_lines[line]['sale_tax_description']"/>
                    </t>
                </td>
                <td class="text-center" name="move_line_aggregated_sale_price_subtotal">
                    <t t-if="aggregated_lines[line]['sale_price_subtotal']">
                        <span t-esc="aggregated_lines[line]['sale_price_subtotal']"
                              t-options="{'widget': 'float', 'precision': aggregated_lines[line]['currency'].decimal_places}"
                        /> <span t-esc="aggregated_lines[line]['currency'].symbol"/>
                    </t>
                </td>
            </t>
        </xpath>
    </template>
</odoo>
